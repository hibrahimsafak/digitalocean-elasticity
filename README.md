# DigitalOcean Autoscale

DigitalOcean Autoscale is a tool to automatic scale your infrastructure on Digital Ocean.

# How it works

DigitalOcean Autoscale runs in a master server that can be used as LoaBalance too. The service will check in every 5 minutes the server's health, if the CPU usage average is more than 80%, DG AutoScale will create a new droplet and register in the LoadBalance. If the CPU usage average is lower than 20%, the service will down one droplet.

# Installation

Just clone this repository:
	
	git clone git@github.com:sergiovilar/digitalocean-autoscale.git

## Requirements

* Vagrant
* Git
* Php 5.3+

# Usage

## Machine configuration

To start using DigitalOcean Autoscale you need to create a VM using [Puphpet](https://puphpet.com/) and select *Digital Ocean* in the first page. Configure your machine and download the .zip containing all the machine configuration.

You'll need to do some changes in the `puphpet/config.yaml` file like [this example](https://github.com/sergiovilar/dg-application-server/blob/master/puphpet/config.yaml), add the ${token} and ${hostname} variables to your file and save.

## Specify your machine

Assuming that the previous code generated by puphpet and modified by you are in a git repository, you'll need to create a `boxes.json` file following the example on `boxes.json.sample`. This file specifies the repository to clone and to start the machine, you need to fill your Digital Ocean token too.

## Running the service

Before run the service is recommended to disable your [know_hosts checking](http://www.joedog.org/2012/07/ssh-disable-known_hosts-prompt/).

Just run:

	php src/initialize.php

If you like to run in a server over ssh, run:

    ./run.sh

If you like to run in a server using ssh